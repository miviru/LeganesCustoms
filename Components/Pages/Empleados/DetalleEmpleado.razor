@page "/detallesEmpleado/{Id:long}"
@inject EmpleadoService EmpleadoService
@inject NavigationManager NavigationManager
@using LeganesCustomsBlazor.Dtos;

<PageTitle>Detalles Empleado</PageTitle>

<div class="container-fluid">
    <div class="row mt-3">
        <div class="col-lg-12">
            <h3>DETALLES DEL EMPLEADO</h3>
        </div>
    </div>

    @if (empleado == null)
    {
        <p>Empleado no encontrado.</p>
    }
    else
    {
        <div class="row mt-4">
            <div class="col-lg-6">
                <h4>Informaci√≥n Personal</h4>
                <table class="table table-bordered text-white">
                    <tr>
                        <th>Nombre</th>
                        <td>@empleado.Nombre</td>
                    </tr>
                    <tr>
                        <th>Primer Apellido</th>
                        <td>@empleado.Apellido1</td>
                    </tr>
                    <tr>
                        <th>Segundo Apellido</th>
                        <td>@empleado.Apellido2</td>
                    </tr>
                    <tr>
                        <th>DNI</th>
                        <td>@empleado.DNI</td>
                    </tr>
                    <tr>
                        <th>Email</th>
                        <td>@empleado.Email</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-lg-6">
                <h4>Citas</h4>
                @if (empleado.Citas != null && empleado.Citas.Any())
                {
                    <ul>
                        @foreach (var cita in empleado.Citas)
                        {
                            <li>Fecha: @cita.Fecha.ToShortDateString()</li>
                        }
                    </ul>
                }
                else
                {
                    <p>No hay citas asociadas.</p>
                }
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-lg-12">
                <NavLink class="btn btn-outline-secondary text-white ms-2" href="@($"/editarEmpleado/{empleado.Id_Empleado}")">Editar</NavLink>
            </div>
        </div>
    }
</div>

@code {
    [Parameter]
    public long Id { get; set; }

    private EmpleadoDto? empleado;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            empleado = await EmpleadoService.GetEmpleadoByIdAsync(Id);
            Console.WriteLine($"Empleado cargado: {empleado?.Nombre}");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error al cargar empleado: {ex.Message}");
        }
    }
}
